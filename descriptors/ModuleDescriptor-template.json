{
  "id": "${artifactId}-${version}",
  "name": "Reservoir",
  "provides": [
    {
      "id": "_tenant",
      "version": "2.0",
      "interfaceType": "system",
      "handlers": [
        {
          "methods": [
            "POST"
          ],
          "pathPattern": "/_/tenant"
        },
        {
          "methods": [
            "GET",
            "DELETE"
          ],
          "pathPattern": "/_/tenant/{id}"
        }
      ]
    },
    {
      "id": "reservoir-config-oai",
      "version": "1.0",
      "handlers": [
        {
          "methods": [
            "GET"
          ],
          "pathPattern": "/reservoir/config/oai",
          "permissionsRequired": [
            "reservoir-config-oai.get"
          ]
        },
        {
          "methods": [
            "PUT"
          ],
          "pathPattern": "/reservoir/config/oai",
          "permissionsRequired": [
            "reservoir-config-oai.put"
          ]
        },
        {
          "methods": [
            "DELETE"
          ],
          "pathPattern": "/reservoir/config/oai",
          "permissionsRequired": [
            "reservoir-config-oai.delete"
          ]
        }
      ]
    },
    {
      "id": "reservoir-config-matchkeys",
      "version": "1.0",
      "handlers": [
        {
          "methods": [
            "POST"
          ],
          "pathPattern": "/reservoir/config/matchkeys",
          "permissionsRequired": [
            "reservoir-config-matchkeys.item.post"
          ]
        },
        {
          "methods": [
            "GET"
          ],
          "pathPattern": "/reservoir/config/matchkeys",
          "permissionsRequired": [
            "reservoir-config-matchkeys.collection.get"
          ]
        },
        {
          "methods": [
            "GET"
          ],
          "pathPattern": "/reservoir/config/matchkeys/{id}",
          "permissionsRequired": [
            "reservoir-config-matchkeys.item.get"
          ]
        },
        {
          "methods": [
            "PUT"
          ],
          "pathPattern": "/reservoir/config/matchkeys/{id}",
          "permissionsRequired": [
            "reservoir-config-matchkeys.item.put"
          ]
        },
        {
          "methods": [
            "DELETE"
          ],
          "pathPattern": "/reservoir/config/matchkeys/{id}",
          "permissionsRequired": [
            "reservoir-config-matchkeys.item.delete"
          ]
        },
        {
          "methods": [
            "PUT"
          ],
          "pathPattern": "/reservoir/config/matchkeys/{id}/initialize",
          "permissionsRequired": [
            "reservoir-config-matchkeys.item.initialize"
          ]
        },
        {
          "methods": [
            "GET"
          ],
          "pathPattern": "/reservoir/config/matchkeys/{id}/stats",
          "permissionsRequired": [
            "reservoir-config-matchkeys.item.stats"
          ]
        }
      ]
    },
    {
      "id": "reservoir-config-modules",
      "version": "1.0",
      "handlers": [
        {
          "methods": [
            "POST"
          ],
          "pathPattern": "/reservoir/config/modules",
          "permissionsRequired": [
            "reservoir-config-modules.item.post"
          ]
        },
        {
          "methods": [
            "GET"
          ],
          "pathPattern": "/reservoir/config/modules",
          "permissionsRequired": [
            "reservoir-config-modules.collection.get"
          ]
        },
        {
          "methods": [
            "GET"
          ],
          "pathPattern": "/reservoir/config/modules/{id}",
          "permissionsRequired": [
            "reservoir-config-modules.item.get"
          ]
        },
        {
          "methods": [
            "PUT"
          ],
          "pathPattern": "/reservoir/config/modules/{id}",
          "permissionsRequired": [
            "reservoir-config-modules.item.put"
          ]
        },
        {
          "methods": [
            "DELETE"
          ],
          "pathPattern": "/reservoir/config/modules/{id}",
          "permissionsRequired": [
            "reservoir-config-modules.item.delete"
          ]
        },
        {
          "methods": [
            "PUT"
          ],
          "pathPattern": "/reservoir/config/modules/{id}/reload",
          "permissionsRequired": [
            "reservoir-config-modules.item.reload"
          ]
        }
      ]
    },
    {
      "id": "reservoir-records",
      "version": "1.0",
      "handlers": [
        {
          "methods": [
            "GET"
          ],
          "pathPattern": "/reservoir/records",
          "permissionsRequired": [
            "reservoir-records.collection.get"
          ]
        },
        {
          "methods": [
            "PUT"
          ],
          "pathPattern": "/reservoir/records",
          "permissionsRequired": [
            "reservoir-records.put"
          ]
        },
        {
          "methods": [
            "DELETE"
          ],
          "pathPattern": "/reservoir/records",
          "permissionsRequired": [
            "reservoir-records.delete"
          ]
        },
        {
          "methods": [
            "GET"
          ],
          "pathPattern": "/reservoir/records/{globalId}",
          "permissionsRequired": [
            "reservoir-records.item.get"
          ]
        }
      ]
    },
    {
      "id": "reservoir-clusters",
      "version": "1.0",
      "handlers": [
        {
          "methods": [
            "GET"
          ],
          "pathPattern": "/reservoir/clusters",
          "permissionsRequired": [
            "reservoir-clusters.collection.get"
          ]
        },
        {
          "methods": [
            "GET"
          ],
          "pathPattern": "/reservoir/clusters/{clusterId}",
          "permissionsRequired": [
            "reservoir-clusters.item.get"
          ]
        },
        {
          "methods": [
            "POST"
          ],
          "pathPattern": "/reservoir/clusters/touch",
          "permissionsRequired": [
            "reservoir-clusters.collection.touch"
          ]
        }
      ]
    },
    {
      "id": "reservoir-oai",
      "version": "1.0",
      "handlers": [
        {
          "methods": [
            "GET"
          ],
          "pathPattern": "/reservoir/oai",
          "permissionsRequired": []
        }
      ]
    },
    {
      "id": "reservoir-oai-pmh-client",
      "version": "1.0",
      "handlers": [
        {
          "methods": [
            "POST"
          ],
          "pathPattern": "/reservoir/pmh-clients",
          "permissionsRequired": [
            "reservoir-pmh-clients.post"
          ]
        },
        {
          "methods": [
            "GET"
          ],
          "pathPattern": "/reservoir/pmh-clients",
          "permissionsRequired": [
            "reservoir-pmh-clients.collection.get"
          ]
        },
        {
          "methods": [
            "GET"
          ],
          "pathPattern": "/reservoir/pmh-clients/{id}",
          "permissionsRequired": [
            "reservoir-pmh-clients.item.get"
          ]
        },
        {
          "methods": [
            "PUT"
          ],
          "pathPattern": "/reservoir/pmh-clients/{id}",
          "permissionsRequired": [
            "reservoir-pmh-clients.item.put"
          ]
        },
        {
          "methods": [
            "DELETE"
          ],
          "pathPattern": "/reservoir/pmh-clients/{id}",
          "permissionsRequired": [
            "reservoir-pmh-clients.item.delete"
          ]
        },
        {
          "methods": [
            "POST"
          ],
          "pathPattern": "/reservoir/pmh-clients/{id}/start",
          "permissionsRequired": [
            "reservoir-pmh-clients.start"
          ]
        },
        {
          "methods": [
            "POST"
          ],
          "pathPattern": "/reservoir/pmh-clients/{id}/stop",
          "permissionsRequired": [
            "reservoir-pmh-clients.stop"
          ]
        },
        {
          "methods": [
            "GET"
          ],
          "pathPattern": "/reservoir/pmh-clients/{id}/status",
          "permissionsRequired": [
            "reservoir-pmh-clients.status"
          ]
        }
      ]
    },
    {
      "id": "reservoir-upload",
      "version": "1.0",
      "handlers": [
        {
          "methods": [
            "POST",
            "PUT"
          ],
          "pathPattern": "/reservoir/upload",
          "permissionsRequired": [
            "reservoir-upload.post"
          ],
          "permissionsDesired": [
            "reservoir-upload.all-sources",
            "reservoir-upload.source.*"
          ]
        }
      ]
    },
    {
      "id": "reservoir-upload-form",
      "version": "1.0",
      "handlers": [
        {
          "methods": [
            "GET",
            "HEAD"
          ],
          "pathPattern": "/reservoir/upload-form*",
          "permissionsRequired": []
        }
      ]
    },
    {
      "id": "reservoir-sru",
      "version": "1.0",
      "handlers": [
        {
          "methods": [
            "GET"
          ],
          "pathPattern": "/reservoir/sru",
          "permissionsRequired": [
            "reservoir-sru.get"
          ]
        }
      ]
    }
  ],
  "requires": [],
  "permissionSets": [
    {
      "permissionName": "reservoir-sru.get",
      "displayName": "reservoir - SRU GET",
      "description": "Perform SRU query"
    },
    {
      "permissionName": "reservoir-config-oai.get",
      "displayName": "reservoir - retrieve OAI configuration",
      "description": "Retrieve OAI configuration"
    },
    {
      "permissionName": "reservoir-config-oai.put",
      "displayName": "reservoir - update OAI configuration",
      "description": "Update OAI configurations"
    },
    {
      "permissionName": "reservoir-config-oai.delete",
      "displayName": "reservoir - delete OAI configuration",
      "description": "Delete OAI configurations"
    },
    {
      "permissionName": "reservoir-config-oai.all",
      "displayName": "reservoir - all OAI configuration permissions",
      "description": "All OAI configuration permissions",
      "subPermissions": [
        "reservoir-config-oai.get",
        "reservoir-config-oai.put",
        "reservoir-config-oai.delete"
      ]
    },
    {
      "permissionName": "reservoir-config-matchkeys.item.post",
      "displayName": "reservoir - create match key configuration",
      "description": "Create match key configuration"
    },
    {
      "permissionName": "reservoir-config-matchkeys.collection.get",
      "displayName": "reservoir - get match key configurations",
      "description": "Get match key configurations"
    },
    {
      "permissionName": "reservoir-config-matchkeys.item.get",
      "displayName": "reservoir - get match key configuration",
      "description": "Get match key configuration"
    },
    {
      "permissionName": "reservoir-config-matchkeys.item.put",
      "displayName": "reservoir - update match key configuration",
      "description": "Update match key configuration"
    },
    {
      "permissionName": "reservoir-config-matchkeys.item.delete",
      "displayName": "reservoir - delete match key configuration",
      "description": "Delete match key configuration"
    },
    {
      "permissionName": "reservoir-config-matchkeys.item.initialize",
      "displayName": "reservoir - initialize match key configuration",
      "description": "Initialize match key configuration"
    },
    {
      "permissionName": "reservoir-config-matchkeys.item.stats",
      "displayName": "reservoir - get match key statistics",
      "description": "Get match key statistics"
    },
    {
      "permissionName": "reservoir-config-matchkeys.all",
      "displayName": "reservoir - all match key configuration",
      "description": "All match key configuration",
      "subPermissions": [
        "reservoir-config-matchkeys.item.post",
        "reservoir-config-matchkeys.collection.get",
        "reservoir-config-matchkeys.item.get",
        "reservoir-config-matchkeys.item.put",
        "reservoir-config-matchkeys.item.delete",
        "reservoir-config-matchkeys.item.initialize",
        "reservoir-config-matchkeys.item.stats"
      ]
    },
    {
      "permissionName": "reservoir-config-modules.item.post",
      "displayName": "reservoir - create code module",
      "description": "Create code module config"
    },
    {
      "permissionName": "reservoir-config-modules.collection.get",
      "displayName": "reservoir - retrieve all code modules",
      "description": "Read all code modules configs"
    },
    {
      "permissionName": "reservoir-config-modules.item.get",
      "displayName": "reservoir - retrieve code module",
      "description": "Read code module config"
    },
    {
      "permissionName": "reservoir-config-modules.item.put",
      "displayName": "reservoir - update code module",
      "description": "Update code module config"
    },
    {
      "permissionName": "reservoir-config-modules.item.delete",
      "displayName": "reservoir - delete code module",
      "description": "Delete code module config"
    },
    {
      "permissionName": "reservoir-config-modules.item.reload",
      "displayName": "reservoir - reload code module",
      "description": "Reload code module config"
    },
    {
      "permissionName": "reservoir-config-modules.all",
      "displayName": "reservoir - all code modules configuration",
      "description": "All code modules configuration",
      "subPermissions": [
        "reservoir-config-modules.item.post",
        "reservoir-config-modules.collection.get",
        "reservoir-config-modules.item.get",
        "reservoir-config-modules.item.put",
        "reservoir-config-modules.item.delete",
        "reservoir-config-modules.item.reload"
      ]
    },
    {
      "permissionName": "reservoir-records.collection.get",
      "displayName": "reservoir - get records",
      "description": "Get records"
    },
    {
      "permissionName": "reservoir-records.put",
      "displayName": "reservoir - ingest records",
      "description": "Ingest records"
    },
    {
      "permissionName": "reservoir-records.delete",
      "displayName": "reservoir - delete records",
      "description": "Delete records"
    },
    {
      "permissionName": "reservoir-records.item.get",
      "displayName": "reservoir - get record",
      "description": "Get record by globalId"
    },
    {
      "permissionName": "reservoir-records.all",
      "displayName": "reservoir - record management",
      "description": "Record management",
      "subPermissions": [
        "reservoir-records.collection.get",
        "reservoir-records.put",
        "reservoir-records.delete",
        "reservoir-records.item.get"
      ]
    },
    {
      "permissionName": "reservoir-clusters.collection.get",
      "displayName": "reservoir - get clusters",
      "description": "Get clusters"
    },
    {
      "permissionName": "reservoir-clusters.item.get",
      "displayName": "reservoir - get cluster",
      "description": "Get cluster"
    },
    {
      "permissionName": "reservoir-clusters.collection.touch",
      "displayName": "reservoir - update clusters timestamp",
      "description": "Update clusters timestamp"
    },
    {
      "permissionName": "reservoir-clusters.all",
      "displayName": "reservoir - clusters",
      "description": "Clusters permissions",
      "subPermissions": [
        "reservoir-clusters.collection.get",
        "reservoir-clusters.item.get",
        "reservoir-clusters.collection.touch"
      ]
    },
    {
      "permissionName": "reservoir-pmh-clients.post",
      "displayName": "reservoir - OAI PMH post",
      "description": "Create OAI PMH client"
    },
    {
      "permissionName": "reservoir-pmh-clients.collection.get",
      "displayName": "reservoir - OAI PMH collection get",
      "description": "Get OAI PMH clients"
    },
    {
      "permissionName": "reservoir-pmh-clients.item.get",
      "displayName": "reservoir - OAI PMH item get",
      "description": "Get OAI PMH client"
    },
    {
      "permissionName": "reservoir-pmh-clients.item.put",
      "displayName": "reservoir - OAI PMH item put",
      "description": "Update OAI PMH client"
    },
    {
      "permissionName": "reservoir-pmh-clients.item.delete",
      "displayName": "reservoir - OAI PMH item delete",
      "description": "Delete OAI PMH client"
    },
    {
      "permissionName": "reservoir-pmh-clients.start",
      "displayName": "reservoir - OAI PMH client start",
      "description": "Start OAI PMH client"
    },
    {
      "permissionName": "reservoir-pmh-clients.stop",
      "displayName": "reservoir - OAI PMH client stop",
      "description": "Stop OAI PMH client"
    },
    {
      "permissionName": "reservoir-pmh-clients.status",
      "displayName": "reservoir - OAI PMH client status",
      "description": "Get OAI PMH status"
    },
    {
      "permissionName": "reservoir-pmh-clients.all",
      "displayName": "reservoir - OAI PMH clients",
      "description": "OAI PMH client permissions",
      "subPermissions": [
        "reservoir-pmh-clients.post",
        "reservoir-pmh-clients.collection.get",
        "reservoir-pmh-clients.item.get",
        "reservoir-pmh-clients.item.put",
        "reservoir-pmh-clients.item.delete",
        "reservoir-pmh-clients.start",
        "reservoir-pmh-clients.stop",
        "reservoir-pmh-clients.status"
      ]
    },
    {
      "permissionName": "reservoir-upload.post",
      "displayName": "reservoir - upload records",
      "description": "Upload MARC binary and MARCXML records"
    },
    {
      "permissionName": "reservoir-upload.all",
      "displayName": "reservoir - upload",
      "description": "upload permissions",
      "subPermissions": [
        "reservoir-upload.post",
        "reservoir-upload.all-sources"
      ]
    },
    {
      "permissionName": "reservoir.all",
      "displayName": "reservoir - all permissions",
      "description": "All permissions",
      "subPermissions": [
        "reservoir-clusters.all",
        "reservoir-config-matchkeys.all",
        "reservoir-config-modules.all",
        "reservoir-config-oai.all",
        "reservoir-pmh-clients.all",
        "reservoir-records.all",
        "reservoir-upload.all",
        "reservoir-sru.get"
      ]
    }
  ],
  "launchDescriptor": {
    "dockerImage": "${artifactId}:${version}",
    "dockerPull": false,
    "dockerArgs": {
      "HostConfig": {
        "Memory": 2147483648,
        "PortBindings": {
          "8081/tcp": [
            {
              "HostPort": "%p"
            }
          ],
          "9090/tcp": [
            {
              "HostPort": "9090"
            }
          ]
        }
      }
    },
    "env": [
      {
        "name": "JAVA_OPTIONS",
        "value": "-XX:MaxRAMPercentage=66.0 --module-path=compiler/ --upgrade-module-path=compiler/compiler.jar:compiler/compiler-management.jar -XX:+UnlockExperimentalVMOptions -XX:+EnableJVMCI -Dmetrics.prometheus.port=9090"
      },
      {
        "name": "DB_HOST",
        "value": "postgres"
      },
      {
        "name": "DB_PORT",
        "value": "5432"
      },
      {
        "name": "DB_USERNAME",
        "value": "folio_admin"
      },
      {
        "name": "DB_PASSWORD",
        "value": "folio_admin"
      },
      {
        "name": "DB_DATABASE",
        "value": "okapi_modules"
      },
      {
        "name": "DB_MAXPOOLSIZE",
        "value": "5"
      }
    ]
  }
}
